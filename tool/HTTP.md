##### HTTP 详解

###### 浏览器缓存

```
根据 `HTTP` 协议头里的 `Cache-Control`（或 `Expires`）和 `Last-Modified`（或 `Etag`）等字段来控制文件缓存的机制。

下面详细介绍`Cache-Control`、`Expires`、`Last-Modified` & `Etag`四个字段。
```

* Cache-Control：用于控制文件在本地缓存有效时长

  ```
  如服务器回包：Cache-Control:max-age=600，则表示文件在本地应该缓存，且有效时长是600秒（从发出请求算起）。在接下来600秒内，如果有请求这个资源，浏览器不会发出 HTTP 请求，而是直接使用本地缓存的文件。
  ```

* Expires：与Cache-Control功能相同，即控制缓存的有效时间

  ```
  1. Expires是 HTTP1.0 标准中的字段，Cache-Control 是 HTTP1.1 标准中新加的字段
  2. 当这两个字段同时出现时，Cache-Control 优先级较高
  ```

* Last-Modified：标识文件在服务器上的最新更新时间

  ```
  下次请求时，如果文件缓存过期，浏览器通过 If-Modified-Since 字段带上这个时间，发送给服务器，由服务器比较时间戳来判断文件是否有修改。如果没有修改，服务器返回304告诉浏览器继续使用缓存；如果有修改，则返回200，同时返回最新的文件。
  ```

* Etag：功能同Last-Modified ，即标识文件在服务器上的最新更新时间。

  ```
  1. 不同的是，Etag 的取值是一个对文件进行标识的特征字串。
  2. 在向服务器查询文件是否有更新时，浏览器通过If-None-Match 字段把特征字串发送给服务器，由服务器和文件最新特征字串进行匹配，来判断文件是否有更新：没有更新回包304，有更新回包200
  3. Etag 和 Last-Modified 可根据需求使用一个或两个同时使用。两个同时使用时，只要满足基中一个条件，就认为文件没有更新。
  ```

  